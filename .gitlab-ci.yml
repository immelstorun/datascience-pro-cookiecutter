stages:
  - sync

sync_to_github:
  stage: sync
  script:
    - git config --global user.name "GitLab CI"
    - git config --global user.email "gitlab-ci@example.com"
    
    # Настроим SSH для доступа к GitHub
    - mkdir -p ~/.ssh
    - chmod 700 ~/.ssh
    - ssh-keyscan github.com >> ~/.ssh/known_hosts
    
    # Клонируем репозиторий с GitLab (безопасный доступ по SSH)
    - git clone --mirror git@gitlab.cspfmba.ru:aseikin/datascience-pro-cookiecutter.git
    - cd datascience-pro-cookiecutter.git
    
    # Пушим изменения в GitHub (замените на свой репозиторий)
    - git remote add github git@github.com:immelstorun/datascience-pro-cookiecutter.git
    - git push --mirror github
  only:
    - main


# stages:
#   - test

# test_job:
#   stage: test
#   script:
#     - echo "Hello, GitLab Runner!"

# stages:
#   - sync

# sync_to_github:
#   stage: sync
#   script:
#     - git config --global user.name "GitLab CI"
#     - git config --global user.email "gitlab-ci@example.com"
#     # Клонируем репозиторий с GitLab
#     - git clone https://gitlab.cspfmba.ru/aseikin/datascience-pro-cookiecutter.git
#     - cd datascience-pro-cookiecutter
#     # Добавляем удалённый репозиторий GitHub с использованием токена
#     - git remote add github https://$GITHUB_TOKEN@github.com/immelstorun/datascience-pro-cookiecutter.git
#     # Проверяем и пуллим последние изменения с GitHub
#     - git fetch github
#     - git merge github/main --strategy-option=theirs || echo "No changes to merge"
#     # Пушим изменения в GitHub
#     - git push github main
#   only:
#     - main


